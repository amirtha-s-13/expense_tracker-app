(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{912:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/piechart",function(){return n(3027)}])},3027:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(5893),o=n(7294),a=n(6100),c=n(9371),i=n(9586),l=n(7872);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){var r;r=n[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,e);var t,n=function(){var e,t,n=h(r);if(function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var o=h(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return(e=t)&&("object"===d(e)||"function"==typeof e)?e:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this)};function r(e){var t;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).props=e,t.chart=void 0,t.chartRef=void 0,t.chartRef=(0,o.createRef)(),t}return p(r.prototype,[{key:"render",value:function(){return(0,o.createElement)("div",{style:this.createStyleForDiv(),ref:this.chartRef})}},{key:"createStyleForDiv",value:function(){var e;return u({height:"100%"},null!==(e=this.props.containerStyle)&&void 0!==e?e:{})}},{key:"componentDidMount",value:function(){var e=this,t=this.applyContainerIfNotSet(this.props.options),n=l.bY.create(t);this.chart=n,n.chart.waitForUpdate().then(function(){var t,r;return null===(t=(r=e.props).onChartReady)||void 0===t?void 0:t.call(r,n)})}},{key:"applyContainerIfNotSet",value:function(e){return e.container?e:u(u({},e),{},{container:this.chartRef.current})}},{key:"shouldComponentUpdate",value:function(e){return this.processPropsChanges(this.props,e),!1}},{key:"processPropsChanges",value:function(e,t){this.chart&&l.bY.update(this.chart,this.applyContainerIfNotSet(t.options))}},{key:"componentWillUnmount",value:function(){this.chart&&(this.chart.destroy(),this.chart=void 0)}}]),t&&p(r,t),r}(o.Component),b=()=>{let{user:e}=(0,c.a)(),[t,n]=(0,o.useState)([]),[l,s]=(0,o.useState)(0),[u,p]=(0,o.useState)(0),[f,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{d()},[e,f]);let d=async()=>{try{let t=e.uid,r=(0,a.JU)(i.db,"users",t),o=await (0,a.QT)(r);if(o.exists()){let e=o.data(),t=e.expenses||[],r=(f?t.filter(e=>e.date&&e.date.split("-")[1]===f):t).map(e=>({...e,date:e.date?new Date(e.date).toLocaleDateString("en-US"):null}));n(r);let a=e.totalIncome||0,c=e.totalExpense||0;s(a),p(c)}else console.error("User document does not exist")}catch(e){console.error("Error fetching expense data:",e)}},b={};t.forEach(e=>{b[e.category]=(b[e.category]||0)+e.expenseAmount});let v=Object.entries(b).map(e=>{let[t,n]=e;return{category:t,total:n,label:t}}),m=l-u;return(0,o.useEffect)(()=>{console.log("chartData:",v),console.log("Total Expense:",u),console.log("Total Income:",l),console.log("Balance Amount:",m)},[v,u,l,m]),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"monthDropdown",className:"mr-2",children:"Select Month:"}),(0,r.jsxs)("select",{id:"monthDropdown",onChange:e=>h(e.target.value),value:f||"",className:"p-2 border rounded-md",children:[(0,r.jsx)("option",{value:"",children:"All Months"}),(0,r.jsx)("option",{value:"01",children:"January"}),(0,r.jsx)("option",{value:"02",children:"February"}),(0,r.jsx)("option",{value:"03",children:"March"}),(0,r.jsx)("option",{value:"04",children:"April"}),(0,r.jsx)("option",{value:"05",children:"May"}),(0,r.jsx)("option",{value:"06",children:"June"}),(0,r.jsx)("option",{value:"07",children:"July"}),(0,r.jsx)("option",{value:"08",children:"August"}),(0,r.jsx)("option",{value:"09",children:"September"}),(0,r.jsx)("option",{value:"10",children:"October"}),(0,r.jsx)("option",{value:"11",children:"November"}),(0,r.jsx)("option",{value:"12",children:"December"})]}),v.length>0?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(y,{options:{width:700,height:600,title:{text:"Expense Distribution"},series:[{type:"pie",angleKey:"total",labelKey:"label",calloutLabelKey:"label",sectorLabelKey:"total",data:v,tooltip:{renderer:e=>{let t=e.datum.label;return"<div>".concat(t,"</div>")}}}]}})}):(0,r.jsx)("p",{children:"No expense data available."})]}),(0,r.jsxs)("div",{className:"ml-14 text-black font-semibold",children:[(0,r.jsxs)("p",{children:["Total Income: Rs ",l]}),(0,r.jsx)("br",{}),(0,r.jsxs)("p",{children:["Total Expense: Rs ",u]}),(0,r.jsx)("br",{}),(0,r.jsxs)("p",{className:m<0?"text-red-500":"text-green-800",children:["Balance Amount: Rs ",m]})]})]})}}},function(e){e.O(0,[786,774,888,179],function(){return e(e.s=912)}),_N_E=e.O()}]);